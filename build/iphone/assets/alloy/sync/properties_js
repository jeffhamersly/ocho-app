function S4(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function guid(){return S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4()}function Sync(t,o,e){var i=o.config.adapter.collection_name?o.config.adapter.collection_name:"default",n=new RegExp("^("+i+")\\-(.+)$"),s=null;if("read"===t)if(o instanceof Backbone.Collection){var r=[];_.each(TAP.listProperties(),function(t){var o=t.match(n);null!==o&&r.push(TAP.getObject(t))}),s=r}else{var a=TAP.getObject(i+"-"+o.id);o.set(a),s=o.toJSON()}else"create"===t||"update"===t?(o.id||(o.id=guid(),o.set(o.idAttribute,o.id)),TAP.setObject(i+"-"+o.id,o.toJSON()||{}),s=o.toJSON()):"delete"===t&&(TAP.removeProperty(i+"-"+o.id),o.clear(),s=o.toJSON());s?(_.isFunction(e.success)&&e.success(s),"read"===t&&o.trigger("fetch")):_.isFunction(e.error)&&e.error(s)}var Alloy=require("alloy"),_=require("alloy/underscore")._,TAP=Ti.App.Properties;module.exports.sync=Sync,module.exports.beforeModelCreate=function(t){return t=t||{},t.columns=t.columns||{},t.defaults=t.defaults||{},("undefined"==typeof t.columns.id||null===t.columns.id)&&(t.columns.id="String"),t};