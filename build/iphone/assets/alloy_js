function ucfirst(t){return t?t[0].toUpperCase()+t.substr(1):t}function addNamespace(t){return(CONST.IMPLICIT_NAMESPACES[t]||CONST.NAMESPACE_DEFAULT)+"."+t}function processStyle(t,o,e,i,n){i=i||{},i.classes=e,o.apiName&&(i.apiName=o.apiName),o.id&&(i.id=o.id),o.applyProperties(exports.createStyle(t,i,n))}function isTabletFallback(){return Math.min(Ti.Platform.displayCaps.platformHeight,Ti.Platform.displayCaps.platformWidth)>=700}function deepExtend(){var t,o,e,i,n,r,a=arguments[0]||{},s=1,l=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[1]||{},s=2),"object"==typeof a||_.isFunction(a)||(a={});l>s;s++)if(t=arguments[s],null!=t){"string"==typeof t&&(t=t.split(""));for(o in t)e=a[o],i=t[o],a!==i&&(u&&i&&_.isObject(i)&&((n=_.isArray(i))||!_.has(i,"apiName"))&&(n?(n=!1,r=e&&_.isArray(e)?e:[]):r=_.isDate(i)?new Date(i.valueOf()):e&&_.isObject(e)?e:{},a[o]=deepExtend(u,r,i)),a[o]=i)}return a}var _=require("alloy/underscore")._,Backbone=require("alloy/backbone"),CONST=require("alloy/constants");exports.version="1.6.0",exports._=_,exports.Backbone=Backbone;var DEFAULT_WIDGET="widget",TI_VERSION=Ti.version,MW320_CHECK=!1,IDENTITY_TRANSFORM=void 0,RESET={bottom:null,left:null,right:null,top:null,height:null,width:null,shadowColor:null,shadowOffset:null,backgroundImage:null,backgroundRepeat:null,center:null,layout:null,backgroundSelectedColor:null,backgroundSelectedImage:null,opacity:1,touchEnabled:!0,enabled:!0,horizontalWrap:!0,zIndex:0,backgroundColor:null,font:null,visible:!0,color:null,transform:null,backgroundGradient:{},borderColor:"transparent",borderRadius:0,borderWidth:0};RESET=_.extend(RESET,{backgroundLeftCap:0,backgroundTopCap:0}),exports.M=function(t,o,e){var i,n=(o||{}).config||{},r=n.adapter||{},a={},s={};r.type?(i=require("alloy/sync/"+r.type),a.sync=function(t,o,e){return i.sync(t,o,e)}):a.sync=function(t,o){Ti.API.warn("Execution of "+t+"#sync() function on a model that does not support persistence"),Ti.API.warn("model: "+JSON.stringify(o.toJSON()))},a.defaults=n.defaults,e&&(s.migrations=e),i&&_.isFunction(i.beforeModelCreate)&&(n=i.beforeModelCreate(n,t)||n);var l=Backbone.Model.extend(a,s);return l.prototype.config=n,_.isFunction(o.extendModel)&&(l=o.extendModel(l)||l),i&&_.isFunction(i.afterModelCreate)&&i.afterModelCreate(l,t),l},exports.C=function(t,o,e){var i,n={model:e},r=(e?e.prototype.config:{})||{};r.adapter&&r.adapter.type?(i=require("alloy/sync/"+r.adapter.type),n.sync=function(t,o,e){return i.sync(t,o,e)}):n.sync=function(t,o){Ti.API.warn("Execution of "+t+"#sync() function on a collection that does not support persistence"),Ti.API.warn("model: "+JSON.stringify(o.toJSON()))};var a=Backbone.Collection.extend(n);return a.prototype.config=r,_.isFunction(o.extendCollection)&&(a=o.extendCollection(a)||a),i&&_.isFunction(i.afterCollectionCreate)&&i.afterCollectionCreate(a),a},exports.UI={},exports.UI.create=function(controller,apiName,opts){opts=opts||{};var baseName,ns,parts=apiName.split(".");if(1===parts.length)baseName=apiName,ns=opts.ns||CONST.IMPLICIT_NAMESPACES[baseName]||CONST.NAMESPACE_DEFAULT;else{if(!(parts.length>1))throw"Alloy.UI.create() failed: No API name was given in the second parameter";baseName=parts[parts.length-1],ns=parts.slice(0,parts.length-1).join(".")}opts.apiName=ns+"."+baseName,baseName=baseName[0].toUpperCase()+baseName.substr(1);var style=exports.createStyle(controller,opts);return eval(ns)["create"+baseName](style)},exports.createStyle=function(t,o,e){var i,n;if(!o)return{};i=_.isArray(o.classes)?o.classes.slice(0):_.isString(o.classes)?o.classes.split(/\s+/):[],n=o.apiName,n&&-1===n.indexOf(".")&&(n=addNamespace(n));var r;r=require(t&&_.isObject(t)?"alloy/widgets/"+t.widgetId+"/styles/"+t.name:"alloy/styles/"+t);var a,s,l={};for(a=0,s=r.length;s>a;a++){var u=r[a],c=u.key;if(u.isApi&&-1===c.indexOf(".")&&(c=(CONST.IMPLICIT_NAMESPACES[c]||CONST.NAMESPACE_DEFAULT)+"."+c),u.isId&&o.id&&u.key===o.id||u.isClass&&_.contains(i,u.key));else{if(!u.isApi)continue;if(-1===u.key.indexOf(".")&&(u.key=addNamespace(u.key)),u.key!==n)continue}u.queries&&u.queries.formFactor&&!Alloy[u.queries.formFactor]||deepExtend(!0,l,u.style)}var f=_.omit(o,[CONST.CLASS_PROPERTY,CONST.APINAME_PROPERTY]);return deepExtend(!0,l,f),l[CONST.CLASS_PROPERTY]=i,l[CONST.APINAME_PROPERTY]=n,MW320_CHECK&&delete l[CONST.APINAME_PROPERTY],e?_.defaults(l,e):l},exports.addClass=function(t,o,e,i){if(!e)return void(i&&(MW320_CHECK&&delete i.apiName,o.applyProperties(i)));var n=o[CONST.CLASS_PROPERTY]||[],r=n.length;e=_.isString(e)?e.split(/\s+/):e;var a=_.union(n,e||[]);return r===a.length?void(i&&(MW320_CHECK&&delete i.apiName,o.applyProperties(i))):void processStyle(t,o,a,i)},exports.removeClass=function(t,o,e,i){e=e||[];var n=o[CONST.CLASS_PROPERTY]||[],r=n.length;if(!r||!e.length)return void(i&&(MW320_CHECK&&delete i.apiName,o.applyProperties(i)));e=_.isString(e)?e.split(/\s+/):e;var a=_.difference(n,e);return r===a.length?void(i&&(MW320_CHECK&&delete i.apiName,o.applyProperties(i))):void processStyle(t,o,a,i,RESET)},exports.resetClass=function(t,o,e,i){e=e||[],e=_.isString(e)?e.split(/\s+/):e,processStyle(t,o,e,i,RESET)},exports.createWidget=function(t,o,e){return"undefined"!=typeof o&&null!==o&&_.isObject(o)&&!_.isString(o)&&(e=o,o=DEFAULT_WIDGET),new(require("alloy/widgets/"+t+"/controllers/"+(o||DEFAULT_WIDGET)))(e)},exports.createController=function(t,o){return new(require("alloy/controllers/"+t))(o)},exports.createModel=function(t,o){return new(require("alloy/models/"+ucfirst(t)).Model)(o)},exports.createCollection=function(t,o){return new(require("alloy/models/"+ucfirst(t)).Collection)(o)},exports.isTablet=function(){return"ipad"===Ti.Platform.osname}(),exports.isHandheld=!exports.isTablet,exports.Globals={},exports.Models={},exports.Models.instance=function(t){return exports.Models[t]||(exports.Models[t]=exports.createModel(t))},exports.Collections={},exports.Collections.instance=function(t){return exports.Collections[t]||(exports.Collections[t]=exports.createCollection(t))},exports.CFG=require("alloy/CFG");